

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Managing Git repositories and SSH keys &mdash; tsuru 0.11.3 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Using" href="../using/index.html" />
    <link rel="prev" title="Upgrading Docker" href="upgrading-docker.html" /> 

<link rel="stylesheet" href="_static/css/theme_overrides.css" type="text/css" />



  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> tsuru
          

          
          </a>

          
            
            
              <div class="version">
                0.11.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../understanding/index.html">Understanding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installing/index.html">Installing</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Managing</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="add-platform.html">Installing platforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="create-platform.html">Creating a platform</a></li>
<li class="toctree-l2"><a class="reference internal" href="using-pools.html">Using Pools</a></li>
<li class="toctree-l2"><a class="reference internal" href="segregate-scheduler.html">Segregate Scheduler</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading-docker.html">Upgrading Docker</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Managing Git repositories and SSH keys</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#managing-ssh-public-keys">Managing SSH public keys</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adding-gandalf-to-an-already-existing-tsuru-cluster">Adding Gandalf to an already existing tsuru cluster</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../using/index.html">Using</a></li>
<li class="toctree-l1"><a class="reference internal" href="../services/index.html">Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced_topics/index.html">Advanced topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases/index.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../roadmap.html">Roadmap</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">tsuru</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Managing</a> &raquo;</li>
        
      <li>Managing Git repositories and SSH keys</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/managing/repositories.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="managing-git-repositories-and-ssh-keys">
<h1>Managing Git repositories and SSH keys<a class="headerlink" href="#managing-git-repositories-and-ssh-keys" title="Permalink to this headline">¶</a></h1>
<p>There are two deployment flavors in tsuru: using <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span></code> and <code class="docutils literal notranslate"><span class="pre">tsuru</span>
<span class="pre">app-deploy</span></code>. The former is optional, while the latter will always be
available. This document focus on the usage of the Git deployment flavor.</p>
<p>In order to allow tsuru users to use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span></code> for deployments, tsuru
administrators need to <a class="reference internal" href="../installing/gandalf.html"><span class="doc">install and configure Gandalf</span></a>.</p>
<p>Gandalf will store and manage all Git repositories and SSH keys, as well as
users. When tsuru is configured to use Gandalf, it will interact with the
Gandalf API in the following actions:</p>
<ul class="simple">
<li>When creating a new user in tsuru, a corresponding user will be created in
Gandalf;</li>
<li>When removing a user from tsuru, the corresponding user will be removed from
Gandalf;</li>
<li>When creating an app in tsuru, a new repository for the app will be created
in Gandalf. All users in the team that owns the app will be authorized to
access this repository;</li>
<li>When removing an app, the corresponding repository will be removed from
Gandalf;</li>
<li>When adding a user to a team in tsuru, the corresponding user in Gandalf will
gain access to all repositories matching the applications that the team has
access to;</li>
<li>When removing a user from a team in tsuru, the corresponding user in Gandalf
will lose access to the repositories that he/she has access to because of the
team he/she is leaving;</li>
<li>When adding a team to an application in tsuru, all users from the team will
gain access to the repository matching the app;</li>
<li>When removing a team from an application in tsuru, all users from the team
will lose access to the repository, unless they’re in another team that also
have access to the application.</li>
</ul>
<p>When user runs a <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span></code>, the communication happens directly between the
user host and the Gandalf host, and Gandalf will notify tsuru the new
deployment using a git hook.</p>
<div class="section" id="managing-ssh-public-keys">
<h2>Managing SSH public keys<a class="headerlink" href="#managing-ssh-public-keys" title="Permalink to this headline">¶</a></h2>
<p>In order to be able to send git pushes to the Git server, users need to have
their key registered in Gandalf. When Gandalf is enabled, tsuru will enable
the usage of three commands for SSH public keys management:</p>
<ul class="simple">
<li>tsuru key-add</li>
<li>tsuru key-remove</li>
<li>tsuru key-list</li>
</ul>
<p>Each of these commands have a corresponding API endpoint, so other clients of
tsuru can also manage keys through the API.</p>
<p>tsuru will not store any public key data, all the data related to SSH keys is
handled by Gandalf alone, and when Gandalf is not enabled, those key commands
will not work.</p>
</div>
<div class="section" id="adding-gandalf-to-an-already-existing-tsuru-cluster">
<h2>Adding Gandalf to an already existing tsuru cluster<a class="headerlink" href="#adding-gandalf-to-an-already-existing-tsuru-cluster" title="Permalink to this headline">¶</a></h2>
<p>In the case of an old tsuru cluster running without Gandalf, users and
applications registered in tsuru won’t be available in the newly created
Gandalf server, or both servers may be out-of-sync.</p>
<p>When Gandalf is enabled, administrators of the cloud can run the <code class="docutils literal notranslate"><span class="pre">tsr</span>
<span class="pre">gandalf-sync</span></code> command.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../using/index.html" class="btn btn-neutral float-right" title="Using" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="upgrading-docker.html" class="btn btn-neutral" title="Upgrading Docker" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, tsuru authors.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Versions</span>
    v: 0.11.3
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dd><a href="/stable/">stable</a></dd>
      <dd><a href="/latest/">latest</a></dd>
      <dd><a href="/main/">main</a></dd>
    </dl>
    <dl>
      <dt>Releases</dt>
      <dd><a href="/1.12/">1.12</a></dd>
      <dd><a href="/1.11/">1.11</a></dd>
      <dd><a href="/1.10/">1.10</a></dd>
      <dd><a href="/1.9/">1.9</a></dd>
      <dd><a href="/1.8/">1.8</a></dd>
      <dd><a href="/1.7/">1.7</a></dd>
      <dd><a href="/1.6/">1.6</a></dd>
      <dd><a href="/1.5/">1.5</a></dd>
      <dd><a href="/1.4/">1.4</a></dd>
      <dd><a href="/1.3/">1.3</a></dd>
      <dd><a href="/1.2/">1.2</a></dd>
      <dd><a href="/1.1/">1.1</a></dd>
      <dd><a href="/1.0/">1.0</a></dd>
      <dd><a href="/0.13/">0.13</a></dd>
      <dd><a href="/0.12/">0.12</a></dd>
      <dd><a href="/0.11/">0.11</a></dd>
      <dd><a href="/0.10/">0.10</a></dd>
      <dd><a href="/0.9/">0.9</a></dd>
      <dd><a href="/0.8/">0.8</a></dd>
      <dd><a href="/0.7/">0.7</a></dd>
      <dd><a href="/0.6/">0.6</a></dd>
      <dd><a href="/0.5/">0.5</a></dd>
      <dd><a href="/0.4/">0.4</a></dd>
      <dd><a href="/0.3/">0.3</a></dd>
      <dd><a href="/0.2/">0.2</a></dd>
      <dd><a href="/0.1/">0.1</a></dd>
    </dl>
    <hr />
  </div>
</div>


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.11.3',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>