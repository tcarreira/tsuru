

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Adding Nodes &mdash; tsuru 1.6.2 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Dashboard" href="dashboard.html" />
    <link rel="prev" title="PlanB Router" href="planb-router.html" /> 

<link rel="stylesheet" href="_static/css/theme_overrides.css" type="text/css" />



  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> tsuru
          

          
          </a>

          
            
            
              <div class="version">
                1.6.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../understanding/index.html">Understanding</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Installing</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="using-tsuru-installer.html">tsuru Installer</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="installing-tsuru-components.html">Installing tsuru components</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="api.html">API Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="planb-router.html">PlanB Router</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Adding Nodes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#managed-nodes">Managed nodes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#unmanaged-nodes">Unmanaged nodes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dashboard.html">Dashboard</a></li>
<li class="toctree-l3"><a class="reference internal" href="gandalf.html">Gandalf (Optional)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../managing/index.html">Managing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using/index.html">Using</a></li>
<li class="toctree-l1"><a class="reference internal" href="../services/index.html">Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced_topics/index.html">Advanced topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plugins/index.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases/index.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../experimental/index.html">Experimental</a></li>
<li class="toctree-l1"><a class="reference internal" href="../roadmap.html">Roadmap</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">tsuru</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Installing</a> &raquo;</li>
        
          <li><a href="installing-tsuru-components.html">Installing tsuru components</a> &raquo;</li>
        
      <li>Adding Nodes</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/installing/adding-nodes.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="adding-nodes">
<h1>Adding Nodes<a class="headerlink" href="#adding-nodes" title="Permalink to this headline">¶</a></h1>
<p>Nodes are physical or virtual machines with a Docker installation.</p>
<p>Nodes can be either unmanaged, which mean that they were created manually,  by
provisioning a machine and installing Docker on it, in which case they have to
be registered in tsuru. Or they can be automatically managed by tsuru, which
will handle machine provisioning and Docker installation using your <a class="reference internal" href="../reference/config.html#iaas-configuration"><span class="std std-ref">IaaS
configuration</span></a>.</p>
<p>The managed option is preferred starting with tsuru-server 0.6.0. There are
advantages like automatically healing and scaling of Nodes. The sections below
describe how to add managed and unmanaged nodes.</p>
<div class="section" id="managed-nodes">
<span id="installing-managed-nodes"></span><h2>Managed nodes<a class="headerlink" href="#managed-nodes" title="Permalink to this headline">¶</a></h2>
<p>First step is configuring your IaaS provider in your tsuru.conf file. Please see
the details in <a class="reference internal" href="../reference/config.html#iaas-configuration"><span class="std std-ref">IaaS configuration</span></a></p>
<p>Assuming you’re using EC2, the configuration will be something like:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">iaas</span><span class="p">:</span>
  <span class="nt">default</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
  <span class="nt">node-protocol</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">http</span>
  <span class="nt">node-port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2375</span>
  <span class="nt">ec2</span><span class="p">:</span>
    <span class="nt">key-id</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">xxxxxxxxxxx</span>
    <span class="nt">secret-key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">yyyyyyyyyyyyy</span>
</pre></div>
</div>
<p>After you have everything configured, adding a new Docker node is done by
calling <a class="reference external" href="http://tsuru-client.readthedocs.io/en/latest/reference.html#add-a-new-node">node-add</a> in
<a class="reference internal" href="../reference/tsuru-client.html"><span class="doc">tsuru</span></a> command. This command will receive
a map of key=value params which are IaaS dependent. A list of possible key
params can be seen calling:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ tsuru node-add docker <span class="nv">iaas</span><span class="o">=</span>ec2

EC2 IaaS required params:
  <span class="nv">image</span><span class="o">=</span>&lt;image id&gt;         Image AMI ID
  <span class="nv">type</span><span class="o">=</span>&lt;instance type&gt;     Your template uuid

Optional params:
  <span class="nv">region</span><span class="o">=</span>&lt;region&gt;          Chosen region, defaults to us-east-1
  <span class="nv">securityGroup</span><span class="o">=</span>&lt;group&gt;    Chosen security group
  <span class="nv">keyName</span><span class="o">=</span>&lt;key name&gt;       Key name <span class="k">for</span> machine
</pre></div>
</div>
<p>Every key=value pair will be added as a metadata to the Node and you can send
After registering your node, you can list it calling <a class="reference external" href="http://tsuru-client.readthedocs.io/en/latest/reference.html#list-nodes-in-cluster">tsuru node-list</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ tsuru node-add docker <span class="nv">iaas</span><span class="o">=</span>ec2 <span class="nv">image</span><span class="o">=</span>ami-dc5387b4 <span class="nv">region</span><span class="o">=</span>us-east-1 <span class="nv">type</span><span class="o">=</span>m1.small <span class="nv">securityGroup</span><span class="o">=</span>my-sec-group <span class="nv">keyName</span><span class="o">=</span>my-key
Node successfully registered.
$ tsuru node-list
+-------------------------------------------------------+------------+---------+----------------------------+
<span class="p">|</span> Address                                               <span class="p">|</span> IaaS ID    <span class="p">|</span> Status  <span class="p">|</span> Metadata                   <span class="p">|</span>
+-------------------------------------------------------+------------+---------+----------------------------+
<span class="p">|</span> http://ec2-xxxxxxxxxxxxx.compute-1.amazonaws.com:2375 <span class="p">|</span> i-xxxxxxxx <span class="p">|</span> waiting <span class="p">|</span> <span class="nv">iaas</span><span class="o">=</span>ec2                   <span class="p">|</span>
<span class="p">|</span>                                                       <span class="p">|</span>            <span class="p">|</span>         <span class="p">|</span> <span class="nv">image</span><span class="o">=</span>ami-dc5387b4         <span class="p">|</span>
<span class="p">|</span>                                                       <span class="p">|</span>            <span class="p">|</span>         <span class="p">|</span> <span class="nv">keyName</span><span class="o">=</span>my-key             <span class="p">|</span>
<span class="p">|</span>                                                       <span class="p">|</span>            <span class="p">|</span>         <span class="p">|</span> <span class="nv">region</span><span class="o">=</span>us-east-1           <span class="p">|</span>
<span class="p">|</span>                                                       <span class="p">|</span>            <span class="p">|</span>         <span class="p">|</span> <span class="nv">securityGroup</span><span class="o">=</span>my-sec-group <span class="p">|</span>
<span class="p">|</span>                                                       <span class="p">|</span>            <span class="p">|</span>         <span class="p">|</span> <span class="nv">type</span><span class="o">=</span>m1.small              <span class="p">|</span>
+-------------------------------------------------------+------------+---------+----------------------------+
</pre></div>
</div>
</div>
<div class="section" id="unmanaged-nodes">
<h2>Unmanaged nodes<a class="headerlink" href="#unmanaged-nodes" title="Permalink to this headline">¶</a></h2>
<p>To add a previously provisioned node you call the <a class="reference external" href="http://tsuru-client.readthedocs.io/en/latest/reference.html#add-a-new-node">tsuru node-add</a> with the
<code class="docutils literal notranslate"><span class="pre">--register</span></code> flag and setting the address key with the URL of the Docker API
in the remote node and specify the pool of the node with <code class="docutils literal notranslate"><span class="pre">pool=mypoolname</span></code>.</p>
<p>The docker API must be responding in the referenced address. To instructions
about how to install docker on your node, please refer to <a class="reference external" href="https://docs.docker.com/">Docker documentation</a>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ tsuru node-add docker <span class="nv">pool</span><span class="o">=</span>mypoolname --register <span class="nv">address</span><span class="o">=</span>http://node.address.com:2375
</pre></div>
</div>
<p>To enable the new unmanaged node run this command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ tsuru node-update http://node.address.com:2375 --enable
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="dashboard.html" class="btn btn-neutral float-right" title="Dashboard" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="planb-router.html" class="btn btn-neutral" title="PlanB Router" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, tsuru authors.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Versions</span>
    v: 1.6.2
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dd><a href="/stable/">stable</a></dd>
      <dd><a href="/latest/">latest</a></dd>
      <dd><a href="/main/">main</a></dd>
    </dl>
    <dl>
      <dt>Releases</dt>
      <dd><a href="/1.12/">1.12</a></dd>
      <dd><a href="/1.11/">1.11</a></dd>
      <dd><a href="/1.10/">1.10</a></dd>
      <dd><a href="/1.9/">1.9</a></dd>
      <dd><a href="/1.8/">1.8</a></dd>
      <dd><a href="/1.7/">1.7</a></dd>
      <dd><a href="/1.6/">1.6</a></dd>
      <dd><a href="/1.5/">1.5</a></dd>
      <dd><a href="/1.4/">1.4</a></dd>
      <dd><a href="/1.3/">1.3</a></dd>
      <dd><a href="/1.2/">1.2</a></dd>
      <dd><a href="/1.1/">1.1</a></dd>
      <dd><a href="/1.0/">1.0</a></dd>
      <dd><a href="/0.13/">0.13</a></dd>
      <dd><a href="/0.12/">0.12</a></dd>
      <dd><a href="/0.11/">0.11</a></dd>
      <dd><a href="/0.10/">0.10</a></dd>
      <dd><a href="/0.9/">0.9</a></dd>
      <dd><a href="/0.8/">0.8</a></dd>
      <dd><a href="/0.7/">0.7</a></dd>
      <dd><a href="/0.6/">0.6</a></dd>
      <dd><a href="/0.5/">0.5</a></dd>
      <dd><a href="/0.4/">0.4</a></dd>
      <dd><a href="/0.3/">0.3</a></dd>
      <dd><a href="/0.2/">0.2</a></dd>
      <dd><a href="/0.1/">0.1</a></dd>
    </dl>
    <hr />
  </div>
</div>


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.6.2',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>